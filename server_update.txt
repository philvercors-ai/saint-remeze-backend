// ===== AJOUTER DANS server.js =====

// AprÃ¨s les autres routes (ligne ~40)
app.use('/api/archive', require('./routes/archive'));

// ===== TÃ‚CHE CRON : Archivage automatique quotidien =====
// Optionnel : Si vous voulez archiver automatiquement tous les jours

const Remark = require('./models/Remark');

// Lancer archivage au dÃ©marrage
(async () => {
  try {
    const result = await Remark.autoArchive();
    console.log('ğŸ—„ï¸  Archivage auto au dÃ©marrage:', result.modifiedCount, 'remarque(s)');
  } catch (err) {
    console.error('âŒ Erreur archivage auto:', err);
  }
})();

// Archivage quotidien (Ã  2h du matin)
setInterval(async () => {
  const now = new Date();
  if (now.getHours() === 2 && now.getMinutes() === 0) {
    try {
      const result = await Remark.autoArchive();
      console.log('ğŸ—„ï¸  Archivage auto quotidien:', result.modifiedCount, 'remarque(s)');
    } catch (err) {
      console.error('âŒ Erreur archivage auto:', err);
    }
  }
}, 60000); // VÃ©rifier chaque minute
